        loss = criterion(out, train_labels_tensor)  # Ensure labels are in tensor format
